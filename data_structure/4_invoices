--CREATING TABLE INVOICES
CREATE OR REPLACE TABLE INVOICES (
  INVOICE_ID         STRING,
  SUBSCRIPTION_ID    STRING,          
  CUSTOMER_ID        STRING,          
  AMOUNT_DUE         NUMBER(18,0),    
  AMOUNT_PAID        NUMBER(18,0),    
  CURRENCY           CHAR(3),
  STATUS             STRING,          
  COLLECTION_METHOD  STRING,
  PERIOD_START       DATE,
  PERIOD_END         DATE,
  CREATED            DATE,            
  DUE_DATE           DATE,
  PAID_DATE          TIMESTAMP_NTZ,
  ATTEMPT_COUNT      NUMBER(5,0),
  DAYS_PAST_DUE      NUMBER(5,0),
  IS_PAST_DUE        BOOLEAN
);

--LOAD .CSV TO THE TABLE
COPY INTO INVOICES
FROM @STG_RAW_FINANCE/invoices.csv
ON_ERROR = 'ABORT_STATEMENT';
